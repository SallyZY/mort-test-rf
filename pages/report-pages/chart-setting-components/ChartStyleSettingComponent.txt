*** Settings ***
Library           Selenium2Library
Resource          ../ReportWorkSpacePage.txt

*** Keywords ***
Click Chart Style Setting Icon
    Click Element    css=div.panelOptionHeader > div:nth-child(3) > div

Set Title of Chart
    [Arguments]    ${chart_title}
    Wait Style Setting Panel Display
    Click Element    css=div.PanelOptionContent > div > div > div:nth-child(1) > div:nth-child(1) > span:nth-child(3) > span > i
    Click Element    xpath=//div[2]/div[2]/div/div/div[1]/div[1]
    # 设置视图标题
    Input Text    xpath=//div[1]//div[2]/div[2]/div/div/div[1]/div[2]/div[1]/span[2]/input    ${chart_title}
    Sleep    2
    # 设置标题居中
    Click Element    xpath=//div[1]/div[2]/div[2]/span[2]/div/input[2]
    Sleep    2
    # 设置标题字体大小
    Select From List By Value    xpath=//div[1]/div[2]/div[4]/span[2]/select    14
    Sleep    2

Set Data Label of Chart
    [Arguments]    ${data_label_item_index}    ${data_label_location}
    Wait Style Setting Panel Display
    Open Style Setting Item by Index    ${data_label_item_index}
    Click Element    css=div.PanelOptionContent > div > div > div:nth-child(${data_label_item_index}) > div:nth-child(1) > span:nth-child(3) > span > i
    # 设置数据标签显示位置
    Select From List By Value    xpath=//div[${data_label_item_index}]/div[2]/div[1]/span[2]/select    ${data_label_location}
    Sleep    2
    # 设置单位为“千”
    Select From List By Value    css= div.PanelOptionContent > div > div > div:nth-child(${data_label_item_index}) > div:nth-child(2) > div:nth-child(4) > span:nth-child(2) > select    thousand
    Sleep    2
    # 设置小数点为两位
    Select From List By Value    css=div.PanelOptionContent > div > div > div:nth-child(${data_label_item_index}) > div:nth-child(2) > div:nth-child(6) > span:nth-child(2) > select    2
    Sleep    2

Set the Style of Legend
    [Arguments]    ${legend_item_index}
    Wait Style Setting Panel Display
    #展开设置项
    Open Style Setting Item by Index    ${legend_item_index}
    #设置图例位置为上部居中
    Select From List By Value    css=div.PanelOptionContent > div > div > div:nth-child(${legend_item_index}) > div:nth-child(2) > div:nth-child(1) > span:nth-child(2) > select    topCenter
    #设置字体大小为14px
    Select From List By Value    css=div.PanelOptionContent > div > div > div:nth-child(${legend_item_index}) > div:nth-child(2) > div:nth-child(4) > span:nth-child(2) > select    14

Open Title of X Axis
    [Arguments]    ${x_axis_item_index}
    Wait Style Setting Panel Display
    #展开设置项
    Open Style Setting Item by Index    ${x_axis_item_index}
    # 打开X轴标题
    Click Element    css=div.PanelOptionContent > div > div > div:nth-child(${x_axis_item_index}) > div:nth-child(2) > div:nth-child(2) > span:nth-child(2) > span > i
    Sleep    2

Open Title of Left Y Axis
    [Arguments]    ${y_axis_item_index}
    Wait Style Setting Panel Display
    #展开设置项
    Open Style Setting Item by Index    ${y_axis_item_index}
    # 打开Y轴标题
    Click Element    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(2) > span:nth-child(2) > span > i
    Sleep    2

Open Title of Right Y Axis
    [Arguments]    ${y_axis_item_index}
    Wait Style Setting Panel Display
    #展开设置项
    Open Style Setting Item by Index    ${y_axis_item_index}
    # 打开Y轴标题
    Click Element    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(2) > span:nth-child(2) > span > i
    Sleep    2

Set Alias of Left Y Axis
    [Arguments]    ${y_axis_item_index}    ${metric_alias_name}
    Wait Style Setting Panel Display
    # 设置指标别名
    Input Text    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(3) > span:nth-child(2) > input    ${metric_alias_name}

Set Alias of Right Y Axis
    [Arguments]    ${y_axis_item_index}    ${metric_alias_name}
    Wait Style Setting Panel Display
    # 设置指标别名
    Input Text    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(3) > span:nth-child(2) > input    ${metric_alias_name}

Set Data Label of Left Y Axis
    [Arguments]    ${y_axis_item_index}
    Wait Style Setting Panel Display
    #设置小数点为1位
    Select From List By Value    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(7) > span:nth-child(2) > select    1
    Sleep    2
    #打开千分位分隔符
    Click Element    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(8) > span:nth-child(2) > span > i
    Sleep    2

Set Data Label of Right Y Axis
    [Arguments]    ${y_axis_item_index}
    Wait Style Setting Panel Display
    #设置单位为”万”
    Select From List By Value    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(6) > span:nth-child(2) > select    tenThousand
    #设置小数点为1位
    Select From List By Value    css=div.PanelOptionContent > div > div > div:nth-child(${y_axis_item_index}) > div:nth-child(2) > div:nth-child(7) > span:nth-child(2) > select    1
    Sleep    2
